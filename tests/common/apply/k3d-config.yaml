apiVersion: k3d.io/v1alpha5
kind: Simple
metadata:
  name: odigos-test
servers: 1
agents: 1
env:
  - envVar: K3S_KUBECONFIG_OUTPUT=/output/kubeconfig.yaml
    nodeFilters:
      - server:0
      - agent:*
  - envVar: K3S_TOKEN=odigos-test-token
    nodeFilters:
      - server:0
      - agent:*
kubeAPI:
  host: "0.0.0.0"
  hostIP: "127.0.0.1"
  hostPort: "6443"
# Note: The image will be overridden by the k3d command with the appropriate version
# Supported versions:
# - v1.20.15: rancher/k3s:v1.20.15-k3s1
# - v1.23: rancher/k3s:v1.23.17-k3s1
# - v1.32: rancher/k3s:v1.32.0-k3s1
image: rancher/k3s:v1.32.0-k3s1
token: odigos-test-token
options:
  k3d:
    wait: true
    timeout: "300s"
    disableLoadbalancer: false
    disableImageVolume: false
  k3s:
    extraArgs:
      - arg: --disable=traefik
        nodeFilters:
          - server:0
      - arg: --disable=servicelb
        nodeFilters:
          - server:0
  kubeconfig:
    updateDefaultKubeconfig: true
    switchCurrentContext: true
